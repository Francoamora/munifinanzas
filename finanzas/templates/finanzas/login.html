{% load static %}

<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <title>Ingreso – Comuna de Tacuarendí</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    {# Bootstrap 5 via CDN #}
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    >

    <style>
      body {
        min-height: 100vh;
        background: radial-gradient(circle at top, #e3f2fd 0, #f8f9fa 45%, #e9ecef 100%);
      }
      .login-card {
        max-width: 380px;
        margin: 0 auto;
      }
      .login-logo {
        max-width: 120px;
        height: auto;
      }
    </style>
  </head>
  <body class="d-flex align-items-center">

    <div class="container">
      <div class="login-card">
        <div class="text-center mb-4">
          {# Ajustá la ruta del logo según dónde lo pongas en static #}
          <img
            src="{% static 'finanzas/img/logo-comuna.png' %}"
            alt="Comuna de Tacuarendí"
            class="login-logo mb-2"
          >
          <h1 class="h5 mb-0">Sistema de Finanzas</h1>
          <p class="text-muted small mb-0">Comuna de Tacuarendí</p>
        </div>

        <div class="card shadow-sm border-0">
          <div class="card-body">
            <h2 class="h6 mb-3 text-center">Ingresar</h2>

            {# Mensajes de error del formulario de login #}
            {% if form.errors %}
              <div class="alert alert-danger py-2 small">
                Usuario o contraseña incorrectos. Volvé a intentarlo.
              </div>
            {% endif %}

            {% if next %}
              {# Si vino redirigido desde una página protegida #}
              <p class="small text-muted">
                Por favor, iniciá sesión para continuar.
              </p>
            {% endif %}

            <form method="post" novalidate>
              {% csrf_token %}

              <div class="mb-3">
                <label class="form-label small" for="{{ form.username.id_for_label }}">
                  Usuario
                </label>
                {{ form.username }}
              </div>

              <div class="mb-3">
                <label class="form-label small" for="{{ form.password.id_for_label }}">
                  Contraseña
                </label>
                {{ form.password }}
              </div>

              <button type="submit" class="btn btn-primary w-100 btn-sm">
                Ingresar
              </button>
              <input type="hidden" name="next" value="{{ next }}">
            </form>
          </div>

          <div class="card-footer text-center py-2">
            <span class="small text-muted">
              Acceso restringido al personal autorizado de la comuna.
            </span>
          </div>
        </div>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>

    <script>
      // Le agregamos clases Bootstrap a los campos sin usar filtros de template
      document.addEventListener("DOMContentLoaded", function () {
        var usernameId = "{{ form.username.id_for_label }}";
        var passwordId = "{{ form.password.id_for_label }}";

        var userInput = document.getElementById(usernameId);
        var passInput = document.getElementById(passwordId);

        [userInput, passInput].forEach(function (el) {
          if (!el) return;
          el.classList.add("form-control", "form-control-sm");
          el.setAttribute("autocomplete", "off");
        });
      });
    </script>
  </body>
</html>
